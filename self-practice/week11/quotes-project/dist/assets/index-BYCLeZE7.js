(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();async function u(t){await fetch(t);let e="";try{const n=await fetch(t);if(console.log(n),!n.ok){switch(n.status){case 404:e="404 - Item not found";break;case 409:e="409 - Conflict";break;default:e="Fail to get item, please try again"}throw new Error(e)}const a=await n.json();return console.log(a),a}catch(n){throw new Error(n.message)}}async function l(t,e){try{const n=await fetch(`${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(n.status!==201)throw new Error("Fail to add item");return n.json()}catch(n){throw new Error(n.message)}}async function m(t,e){try{if(!(await fetch(`${t}/${e}`,{method:"DELETE"})).ok)throw new Error("Fail to delete item");return e}catch(n){throw new Error(n.message)}}const s="http://localhost:5100/quotes";async function h(){try{const t=await u(s);return console.log(t),t}catch(t){alert(`Quote: ${t}`)}}async function f(t){try{return await l(s,t)}catch(e){alert(`Quote: ${e}`)}}async function p(t){try{return await editItem(s,t)}catch(e){alert(`Quote: ${e}`)}}async function E(t){try{return await m(s,t)}catch(e){alert(`Quote: ${e}`)}}document.addEventListener("DOMContentLoaded",async()=>{const t=await h();console.log(t);const e=document.getElementById("quoteList");t.forEach(n=>{const a=i(n);e.appendChild(a)})});function i(t){const e=document.createElement("div");e.className="quote-card",e.dataset.id=t.id;const n=document.createElement("p");n.textContent=t.content,e.appendChild(n);const a=document.createElement("p");a.className="author",a.textContent=t.author,e.appendChild(a);const o=document.createElement("div");o.className="actions";const r=document.createElement("button");r.className="edit",r.dataset.id=t.id,r.textContent="Edit",o.appendChild(r),r.addEventListener("click",y);const c=document.createElement("button");return c.className="delete",c.dataset.id=t.id,c.textContent="Delete",o.appendChild(c),c.addEventListener("click",w),e.appendChild(o),e}function y(t){const e=t.target.dataset.id,n=document.querySelector(`div[data-id="${e}"]`),a=document.getElementById("quoteForm");a.quoteId.value=e,a.content.value=n.children[0].textContent,a.author.value=n.children[1].textContent}async function w(t){const e=t.target.dataset.id;if(confirm(`Do you want to delete quote: ${e} `))try{const a=await E(e),o=document.querySelector(`div[data-id="${a}"]`),r=document.querySelector("#quoteList");console.log(r),r.removeChild(o)}catch(a){alert(`App: ${a.message}`)}}const d=document.getElementById("quoteForm");d.addEventListener("submit",v);async function v(t){t.preventDefault();const e=d.quoteId.value,n=d.content.value,a=d.author.value;if(e)try{const o=await p({id:e,content:n,author:a}),r=document.querySelector(`div[data-id="${o.id}"]`);r.children[0].textContent=o.content,r.children[1].textContent=o.author}catch(o){console.log(`App [Edit]: ${o.message}`)}else try{const o=await f({content:n,author:a}),r=i(o);document.getElementById("quoteList").appendChild(r)}catch(o){alert(`App [Add]: ${o.message}`)}d.quoteId.value="",d.content.value="",d.author.value=""}
